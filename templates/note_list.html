<!DOCTYPE html>
{% extends 'base.html' %}
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Flimn | Заметки{% endblock title %}</title>
</head>

<body>
{% block content %}
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <button type="button" class="btn-mg" id="scroll_bottom_button">
        <i class="fas fa-arrow-down"></i>
    </button>
    <button type="button" class="btn btn-dark button-list-container" style="float: left;"
            data-toggle="modal" data-target="#notesModal" id="note-create-state" onclick="click_note_create()">
        Создать заметку
    </button>
    <br/>
    <div class="list-container">
        <div class="dflex-row">
        </div>
        <div class="modal fade" id="notesModal" tabindex="-1" aria-labelledby="exampleModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-center">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Создать заметку</h5>
                        <button type="button" class="close close-outline" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form id="create-note-form" class="modal-form">
                        <div class="modal-body" id="modal-body">
                            <div class="dflex-column">
                                {% csrf_token %}
                                <input maxlength="255" data-name="Заголовок заметки" class="modal-input"
                                       name="note-title" id="note-title"
                                       placeholder="Заголовок заметки" required/>
                                <textarea data-name="Текст заметки" class="modal-textarea" name="note-body"
                                          id="note-body"
                                          placeholder="Текст заметки" required></textarea>
                            </div>
                            <input id="note-edit-state" name="note-edit-state" hidden>
                            <input id="note-id" name="note-id" hidden>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                            <button type="submit" class="btn btn-primary" id="save-note-button">Сохранить</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% if notes|length != 0 %}
            {% for note in notes %}
                <div class="card card text-white bg-info mb-3 card-min">
                    <div class="card-header">
                        <span class="font-weight-bold">{{ note.title }}</span>
                        &middot;
                        {{ note.date }}
                        {% if user.pk == note.author.pk %}
                            <div style="float:right;">
                                <button type="button" class="blk-btn note-edit" id="note-edit" data-toggle="modal"
                                        data-target="#notesModal"
                                        onclick="click_note_edit({{ note.id }}, '{{ note.title }}', '{{ note.body }}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button type="button" class="blk-btn note-delete" id="note-delete" data-toggle="modal"
                                        data-target="#notesModal"
                                        onclick="click_note_delete({{ note.id }}, '{{ note.title }}', '{{ note.body }}')">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <p>{{ note.body }}</p>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>Заметок пока не создано:(</p>
        {% endif %}
    </div>
    <br/>
    <button type="button" class="btn btn-dark button-list-container" style="float: left; margin-top: 15px;"
            data-toggle="modal" data-target="#notesModal">
        Создать заметку
    </button>
    <button type="button" class="btn-mg button-list-container" style="margin-bottom: 40px; margin-top: 15px;"
            id="scroll_bottom_top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <script type="text/javascript">
        $("#all-notes").text("Все заметки({{ notes|length }})")
    </script>
    <script type="text/javascript" src="{% static 'js/notes.js' %}"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/8.11.8/sweetalert2.all.min.js"></script>
{% endblock content %}
</body>

</html>